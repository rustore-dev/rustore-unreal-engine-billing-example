<?xml version="1.0" encoding="utf-8"?>
<root xmlns:android="http://schemas.android.com/apk/res/android">

  <prebuildCopies>
    <copyDir src="$S(PluginDir)/Private/Java" dst="$S(BuildDir)/src/com/Plugins/RuStoreBilling" />
  </prebuildCopies>

  <resourceCopies>
    <copyDir src="$S(PluginDir)/ThirdParty/Android" dst="$S(BuildDir)/libs" />
  </resourceCopies>

  <buildGradleAdditions>
    <insert>
      ext.billing_type = ''
      
      if (project.hasProperty("rustore_sdk_type")) {
        billing_type = rustore_sdk_type
      }
      
      dependencies {
        // RuStore Billing
        implementation ("ru.rustore.sdk:billingclient:1.1.1$billing_type")
        implementation files("src/main/libs/RuStoreUnityBillingClient${billing_type}.aar")
      }
    </insert>
  </buildGradleAdditions>

  <gameActivityImportAdditions>
    <insert>import ru.rustore.unitysdk.billingclient.RuStoreUnityBillingClient;</insert>
  </gameActivityImportAdditions>

  <gameActivityOnCreateAdditions>
    <insert>
        if (savedInstanceState == null)
        {
            RuStoreUnityBillingClient.onNewIntent(getIntent());
        }</insert>
  </gameActivityOnCreateAdditions>

  <gameActivityOnNewIntentAdditions>
    <insert>
        RuStoreUnityBillingClient.onNewIntent(newIntent);
    </insert>
  </gameActivityOnNewIntentAdditions>
  
</root>
